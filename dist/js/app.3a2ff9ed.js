(function(e){function t(t){for(var s,r,o=t[0],u=t[1],l=t[2],d=0,m=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&m.push(n[r][0]),n[r]=0;for(s in u)Object.prototype.hasOwnProperty.call(u,s)&&(e[s]=u[s]);c&&c(t);while(m.length)m.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],s=!0,o=1;o<a.length;o++){var u=a[o];0!==n[u]&&(s=!1)}s&&(i.splice(t--,1),e=r(r.s=a[0]))}return e}var s={},n={app:0},i=[];function r(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=s,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(a,s,function(t){return e[t]}.bind(null,s));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/firebase-chat/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var c=u;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"206d":function(e,t,a){"use strict";var s=a("2e15"),n=a.n(s);n.a},"21bb":function(e,t,a){"use strict";var s=a("b3f0"),n=a.n(s);n.a},"25f2":function(e,t,a){},"2e15":function(e,t,a){},"4d31":function(e,t,a){"use strict";var s=a("ef0a"),n=a.n(s);n.a},"56d7":function(e,t,a){"use strict";a.r(t);a("9def"),a("9cac"),a("10d9"),a("a107"),a("925a");var s,n,i=a("ed16"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"appRef",staticClass:"app",attrs:{id:"app"}},[a("div",{attrs:{"uk-sticky":"sel-target: uk-navbar-container; cls-active: uk-navbar-sticky"}},[a("nav",{staticClass:"uk-navbar-container",attrs:{"uk-navbar":""}},[a("div",{staticClass:"uk-navbar-left"},[a("ul",{staticClass:"uk-navbar-nav"},[e.user.loggedIn?[a("li",{class:{"uk-active":"Home"===e.$router.currentRoute.name}},[a("router-link",{attrs:{to:"/"}},[e._v("Home")])],1),a("li",[a("a",{attrs:{href:"#"},on:{click:e.signOut}},[e._v("Logout")])])]:[a("li",{class:{"uk-active":"Login"===e.$router.currentRoute.name}},[a("router-link",{attrs:{to:"/login"}},[e._v("Login")])],1),a("li",{class:{"uk-active":"Register"===e.$router.currentRoute.name}},[a("router-link",{attrs:{to:"/register"}},[e._v("Register")])],1)]],2)])])]),a("notifications",{attrs:{group:"messages-success",position:"top center",classes:"vue-notification success"}}),a("notifications",{attrs:{group:"messages-error",position:"top center",classes:"vue-notification error"}}),a("notifications",{attrs:{group:"messages-warning",position:"top center",classes:"vue-notification warning"}}),a("base-transition",[a("router-view")],1)],1)},o=[],u=a("d78c"),l=a("f8e7"),c=a("26c2"),d=a.n(c),m=(a("82c8"),a("d65f")),f=a.n(m),p={name:"BaseTransition",functional:!0,props:{type:{type:String,default:"fade"},mode:{type:String,default:"out-in"},duration:{type:Number,default:100},direction:{type:String,default:null}},render:function(e,t){var a,s,n=t.props,i=t.children,r={props:{mode:n.mode,duration:n.duration}};function o(e){e.style.transitionDuration="".concat(n.duration,"ms")}function u(e){e.style.transitionDuration=""}switch(n.type){case"fade":a=n.direction?"fade-".concat(n.direction):"fade",s={beforeEnter:o,afterEnter:u,beforeLeave:o,afterLeave:u};break;case"expand":a="expand",s={beforeEnter:o,afterEnter:function(e){e.style.height="auto"},enter:function(e){var t=getComputedStyle(e),a=t.width;e.style.width=a,e.style.position="absolute",e.style.visibility="hidden",e.style.height="auto";var s=getComputedStyle(e),n=s.height;e.style.width=null,e.style.position=null,e.style.visibility=null,e.style.height=0,getComputedStyle(e).height,requestAnimationFrame((function(){e.style.height=n}))},beforeLeave:o,leave:function(e){var t=getComputedStyle(e),a=t.height;e.style.height=a,getComputedStyle(e).height,requestAnimationFrame((function(){e.style.height=0}))},afterLeave:u};break}return r.props.name=a,r.on=s,e("transition",f()([{},r]),[i])}},g=p,h=(a("9dd4"),a("4d31"),a("aa22")),v=Object(h["a"])(g,s,n,!1,null,"07ac98cb",null),k=v.exports,b={name:"App",components:{BaseTransition:k},computed:Object(u["a"])({},Object(l["c"])(["user"])),methods:{signOut:function(){d.a.auth().signOut()}}},y=b,w=(a("5c0b"),Object(h["a"])(y,r,o,!1,null,null,null)),_=w.exports,x=a("b1b9"),C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"uk-container uk-container-large"},[a("div",{ref:"messagesRef",staticClass:"uk-overflow-auto uk-height-small uk-height-max uk-padding-small uk-padding-remove-left",attrs:{"uk-height-viewport":"offset-top: true; offset-bottom: true; expand: true;"}},[a("button",{staticClass:"uk-button uk-button-default uk-width-1-1 uk-width-1-4@s",attrs:{disabled:e.loadMoreDisabled},on:{click:function(t){!e.loadMoreDisabled&&e.loadMore()}}},[e._v("Load more")]),e._l(e.messagesArray,(function(t){return a("div",{key:t.id,staticClass:"message",class:{"message--editing":e.editMessage===t,"message--yours":t.user_id===e.user.data.uid}},[a("div",{staticClass:"uk-padding uk-padding-remove-left uk-padding-remove-vertical message__username"},[e._v(e._s(t.user_id===e.user.data.uid?"You":t.user_nickname)+":")]),e.editMessage!==t?[a("span",{staticClass:"message__text"},[e._v(e._s(t.text))])]:[a("textarea",{directives:[{name:"focus",rawName:"v-focus"},{name:"model",rawName:"v-model.trim",value:e.editMessageText,expression:"editMessageText",modifiers:{trim:!0}}],staticClass:"message__textarea",attrs:{rows:"1"},domProps:{value:e.editMessageText},on:{keydown:[function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:(a.preventDefault(),e.updateMessage(t))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:(t.preventDefault(),e.cancelEdit(t))}],input:function(t){t.target.composing||(e.editMessageText=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})],t.user_id===e.user.data.uid?a("ul",{staticClass:"uk-iconnav message__actions"},[e.editMessage!==t?[a("a",{attrs:{href:"#","uk-icon":"icon: pencil"},on:{click:function(a){return e.edit(t)}}}),a("a",{attrs:{href:"#","uk-icon":"icon: trash"},on:{click:function(a){return e.removeMessage(t)}}})]:[a("a",{attrs:{href:"#","uk-icon":"icon: close"},on:{click:e.cancelEdit}}),a("a",{attrs:{href:"#","uk-icon":"icon: check"},on:{click:function(a){return e.updateMessage(t)}}})]],2):e._e()],2)}))],2),a("form",{staticClass:"uk-grid-small uk-child-width-1-1@s uk-padding-small uk-padding-remove-horizontal",attrs:{"uk-grid":""},on:{submit:function(t){return t.preventDefault(),e.addMessage(t)}}},[a("div",{staticClass:"uk-inline"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.text,expression:"text",modifiers:{trim:!0}}],staticClass:"uk-input",attrs:{required:"",type:"text",placeholder:"Enter message"},domProps:{value:e.text},on:{input:function(t){t.target.composing||(e.text=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])])])},M=[],S=(a("446b"),a("d786"),a("eead"),a("7357"),a("bbfc"),a("daeb"),a("b349")),O={apiKey:"AIzaSyDefialhwGz34Hl5nR6Prc_6_he4ZAkzHo",authDomain:"chat-room-eed70.firebaseapp.com",databaseURL:"https://chat-room-eed70.firebaseio.com",projectId:"chat-room-eed70",storageBucket:"chat-room-eed70.appspot.com",messagingSenderId:"806392955157",appId:"1:806392955157:web:579074ed17cf005010291c",measurementId:"G-MVKTHTVSTZ"},E=d.a.initializeApp(O),T=E.database().ref("messages"),$={name:"Home",data:function(){return{messages:{},nickname:"Anonymous",text:"",editMessage:null,editMessageText:null,showNew:!0,isMobile:!1,paginationSize:3,curSize:3,minSize:3,loadMoreDisabled:!1}},computed:Object(u["a"])({},Object(l["c"])(["user"]),{messagesArray:function(){var e=this;return Object.keys(this.messages).map((function(t){return Object(u["a"])({},e.messages[t],{id:t})}))},scrollToBottom:function(){return this.isMobile||this.showNew}}),methods:{login:function(){var e=this,t="+",a=t+this.phone+"@domainName.com",s=this.password;firebase.auth().signInWithEmailAndPassword(a,s).then((function(){e.$router.push({path:"/home"})})).catch((function(e){e.code,e.message;var t=e.message.toLowerCase();while(-1!=t.indexOf("email"))t=t.replace("email address","phone number");alert("Error: "+t)}))},addMessage:function(){this.text&&(T.push({user_id:this.user.data.uid,user_nickname:this.user.data.displayName,text:this.text}).then((function(e){})).catch((function(e){})),this.text="")},removeMessage:function(e){T.child(e.id).remove().then((function(e){})).catch((function(e){}))},updateMessage:function(e){T.child(e.id).update({text:this.editMessageText}),this.editMessage=null,this.editMessageText=null},edit:function(e){this.editMessage=e,this.editMessageText=e.text},cancelEdit:function(){this.editMessage=null,this.editMessageText=null},scrollBottom:function(){this.$refs.messagesRef.scrollTop=this.$refs.messagesRef.scrollHeight-this.$refs.messagesRef.clientHeight},showNewHandler:function(){this.$refs.messagesRef.scrollTop!==this.$refs.messagesRef.scrollHeight-this.$refs.messagesRef.clientHeight&&this.showNew?this.showNew=!1:this.$refs.messagesRef.scrollTop!==this.$refs.messagesRef.scrollHeight-this.$refs.messagesRef.clientHeight||this.showNew||(this.showNew=!0)},requestLastNItems:function(e){return T.limitToLast(e).once("value")},loadMore:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var a,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e,t.next=3,e.requestLastNItems(e.messagesArray.length+e.paginationSize);case 3:s=t.sent,n=s.val(),Object.keys(n).length===a.messagesArray.length&&(a.loadMoreDisabled=!0),a.messages=n||{};case 7:case"end":return t.stop()}}),t)})))()}},created:function(){var e=this;/Mobi|Android/i.test(navigator.userAgent)&&(this.isMobile=!0);var t=this,a=localStorage.getItem("nickname");if(a)this.nickname=a;else{var s=prompt("Enter nickname","Anonymous")||"Anonymous";this.nickname=s,localStorage.setItem("nickname",this.nickname)}T.limitToLast(this.paginationSize).once("value",(function(a){var s=a.val();e.messages=s||{},t.$nextTick((function(){return t.scrollBottom()})),T.limitToLast(1).on("child_added",(function(a){var s=a.key,n=a.val();t.messages[s]||(e.$set(e.messages,s,n),n.user_id!==t.user.data.uid&&t.$notify({group:"messages-success",title:"Message",text:"User ".concat(n.user_nickname," added new message")}),t.scrollToBottom&&t.$nextTick((function(){return t.scrollBottom()})))})),T.on("child_removed",(function(e){var a=e.key,s=e.val();if(t.$delete(t.messages,a),s.user_id!==t.user.data.uid)return t.$notify({group:"messages-error",title:"Message",text:"User ".concat(s.user_nickname," removed message")})})),T.on("child_changed",(function(e){var a=e.key,s=e.val();if(t.messages[a]=s,s.user_id!==t.user.data.uid)return t.$notify({group:"messages-warning",title:"Message",text:"User ".concat(s.user_nickname," edited message")})}))}))}},j=$,N=(a("21bb"),Object(h["a"])(j,C,M,!1,null,null,null)),R=N.exports,L=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"uk-container uk-container-xsmall"},[a("form",{staticClass:"uk-padding uk-grid-small uk-child-width-1-1@s",attrs:{"uk-grid":""},on:{submit:function(t){return t.preventDefault(),e.submit(t)}}},[a("div",{staticClass:"uk-inline uk-padding-remove-horizontal uk-margin-small"},[a("span",{staticClass:"uk-form-icon",attrs:{"uk-icon":"icon: user"}}),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.email,expression:"form.email"}],staticClass:"uk-input",attrs:{id:"email",required:"",type:"email",name:"email",placeholder:"Enter email"},domProps:{value:e.form.email},on:{input:function(t){t.target.composing||e.$set(e.form,"email",t.target.value)}}})]),a("div",{staticClass:"uk-inline uk-padding-remove-horizontal uk-margin-small"},[a("span",{staticClass:"uk-form-icon uk-form-icon",attrs:{"uk-icon":"icon: lock"}}),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.password,expression:"form.password"}],staticClass:"uk-input",attrs:{id:"password",type:"password",name:"password",required:"",placeholder:"Enter password"},domProps:{value:e.form.password},on:{input:function(t){t.target.composing||e.$set(e.form,"password",t.target.value)}}})]),a("div",{staticClass:"uk-inline uk-padding-remove-horizontal uk-margin-small"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.name,expression:"form.name"}],staticClass:"uk-input",attrs:{required:"",type:"text",name:"username",placeholder:"Enter desired username"},domProps:{value:e.form.name},on:{input:function(t){t.target.composing||e.$set(e.form,"name",t.target.value)}}})]),a("button",{staticClass:"uk-button uk-button-default uk-margin-small uk-button-primary",attrs:{type:"submit"}},[e._v("Submit")])])])},A=[],P=(a("4195"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"loader"},[e._v("Loading...")])}),H=[],I={name:"BaseSpinner"},z=I,D=(a("5cd3"),Object(h["a"])(z,P,H,!1,null,"693b8422",null)),B=D.exports,U={data:function(){return{form:{name:"",email:"",password:""},error:null,loading:!1}},components:{BaseSpinner:B,BaseTransition:k},methods:Object(u["a"])({},Object(l["b"])(["fetchUser"]),{submit:function(){var e=this;this.loading=!0,d.a.auth().createUserWithEmailAndPassword(this.form.email,this.form.password).then((function(t){var a=t.user;a.updateProfile({displayName:e.form.name}).then((function(){e.fetchUser(a)}))})).catch((function(t){e.error=t.message})).finally((function(){e.loading=!1}))}})},q=U,G=Object(h["a"])(q,L,A,!1,null,null,null),W=G.exports,F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"uk-container uk-container-xsmall"},[a("form",{staticClass:"uk-padding uk-grid-small uk-child-width-1-1@s",attrs:{"uk-grid":""},on:{submit:function(t){return t.preventDefault(),e.submit(t)}}},[a("div",{staticClass:"uk-inline uk-padding-remove-horizontal uk-margin-small"},[a("span",{staticClass:"uk-form-icon",attrs:{"uk-icon":"icon: user"}}),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.email,expression:"form.email"}],staticClass:"uk-input",attrs:{id:"email",required:"",type:"email",name:"email"},domProps:{value:e.form.email},on:{input:function(t){t.target.composing||e.$set(e.form,"email",t.target.value)}}})]),a("div",{staticClass:"uk-inline uk-padding-remove-horizontal uk-margin-small"},[a("span",{staticClass:"uk-form-icon uk-form-icon-flip",attrs:{"uk-icon":"icon: lock"}}),a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.password,expression:"form.password"}],staticClass:"uk-input",attrs:{id:"password",type:"password",name:"password",required:""},domProps:{value:e.form.password},on:{input:function(t){t.target.composing||e.$set(e.form,"password",t.target.value)}}})]),a("button",{staticClass:"uk-button uk-button-default uk-margin-small",attrs:{type:"submit"}},[e._v("Submit")])])])},J=[],K={data:function(){return{form:{email:"",password:""},error:null,loading:!1}},components:{BaseSpinner:B,BaseTransition:k},methods:{submit:function(){var e=this;this.loading=!0,d.a.auth().signInWithEmailAndPassword(this.form.email,this.form.password).then((function(){})).catch((function(t){e.error=t.message})).finally((function(){e.loading=!0}))}}},V=K,Z=(a("206d"),Object(h["a"])(V,F,J,!1,null,null,null)),Y=Z.exports;i["default"].use(l["a"]);var Q=new l["a"].Store({state:{user:{loggedIn:!1,data:null}},getters:{user:function(e){return e.user}},mutations:{SET_LOGGED_IN:function(e,t){e.user.loggedIn=t},SET_USER:function(e,t){e.user.data=t}},actions:{fetchUser:function(e,t){var a=e.commit;a("SET_LOGGED_IN",null!==t),a("SET_USER",t?{displayName:t.displayName,email:t.email,uid:t.uid}:null)}},modules:{}});i["default"].use(x["a"]);var X=[{path:"/",name:"Home",component:R},{path:"/register",name:"Register",component:W},{path:"/login",name:"Login",component:Y}],ee=new x["a"]({mode:"history",base:"/firebase-chat/",routes:X});ee.beforeEach((function(e,t,a){var s=Q.getters.user.loggedIn;"Home"!==e.name||s||"Login"===t.name?a():a({name:"Login"})}));var te=ee,ae=a("acab"),se=a.n(ae),ne=a("4e2a"),ie=a.n(ne),re=a("6e7a"),oe=a.n(re);a("9c01");ie.a.use(oe.a),i["default"].use(se.a),i["default"].config.productionTip=!1,new i["default"]({router:te,store:Q,render:function(e){return e(_)}}).$mount("#app"),i["default"].directive("focus",{inserted:function(e){e.focus()}}),d.a.auth().onAuthStateChanged((function(e){Q.dispatch("fetchUser",e),e&&"Home"!==te.currentRoute.name?te.push({name:"Home"}):"Login"!==te.currentRoute.name&&te.push({name:"Login"})}))},5824:function(e,t,a){},"5c0b":function(e,t,a){"use strict";var s=a("25f2"),n=a.n(s);n.a},"5cd3":function(e,t,a){"use strict";var s=a("5824"),n=a.n(s);n.a},"9dd4":function(e,t,a){"use strict";var s=a("e158"),n=a.n(s);n.a},b3f0:function(e,t,a){},e158:function(e,t,a){},ef0a:function(e,t,a){}});
//# sourceMappingURL=app.3a2ff9ed.js.map